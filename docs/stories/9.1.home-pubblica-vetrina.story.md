---
status: drafted
priority: high
estimate: M
story_id: "9.1"
epic: "Epic 9 - Vetrina Pubblica e Lead Capture"
---

# Story 9.1: Home Pubblica Vetrina

**As a** Visitor, **I want** a clear homepage with service highlights and calls to action, **so that** I can quickly understand what the workshop offers.

## Acceptance Criteria

### AC-1
_Derived from epic-details AC-1._
**Given** an anonymous visitor opens route / on desktop viewport 1366x768
**When** the homepage finishes rendering
**Then** the page shows: (1) hero section with heading Riparazioni rapide e trasparenti, (2) service highlights with at least 3 cards containing 	itolo, prezzo indicativo, and 	empo medio, (3) trust blocks Recensioni, FAQ, Contatti, and (4) a visible CTA button with exact label Richiedi preventivo and href /richiedi-preventivo

### AC-2
_Derived from epic-details AC-2._
**Given** an anonymous visitor opens route / on mobile viewport width 390px
**When** the same homepage content is rendered
**Then** layout remains fully responsive with document.documentElement.scrollWidth <= 390 and no horizontal overflow

### AC-3
_Derived from epic-details AC-3._
**Given** frontend build is served in preview mode on http://127.0.0.1:4173/
**When** Lighthouse CLI runs with mobile profile and output JSON (lighthouse http://127.0.0.1:4173/ --only-categories=performance --emulated-form-factor=mobile --throttling-method=simulate --chrome-flags="--headless" --output=json --output-path=docs/sprint-artifacts/lighthouse-9.1.json)
**Then** categories.performance.score in docs/sprint-artifacts/lighthouse-9.1.json is >= 0.85

### AC-4
_Derived from epic-details AC-4._
**Given** the homepage renders CTA Accedi al portale cliente
**When** the visitor clicks that CTA
**Then** browser navigation targets /portale/login

### AC-5
_Derived from validation hardening (sad path for invalid query input)._ 
**Given** a visitor opens route /?layout=broken where layout is an unsupported query value
**When** the homepage renders with that query string
**Then** hero, services, and trust sections are still visible and both CTA links keep targets /richiedi-preventivo and /portale/login without runtime errors

## Target Modules

- gestionale_riparazioni/urls.py
- packages/frontend/src/App.tsx
- packages/frontend/src/main.tsx
- packages/frontend/src/index.css
- packages/frontend/vitest.config.ts
- package.json

## Task Breakdown

- [x] Task 1 (AC-1): replace placeholder UI in packages/frontend/src/App.tsx with a public home layout containing hero, service highlights, trust blocks, CTA Richiedi preventivo, and href /richiedi-preventivo.
- [x] Task 2 (AC-2): extend responsive styles in packages/frontend/src/index.css and/or Tailwind utility composition in packages/frontend/src/App.tsx to guarantee no horizontal overflow at 390px width.
- [x] Task 3 (AC-4): add CTA navigation in packages/frontend/src/App.tsx so Accedi al portale cliente routes to /portale/login.
- [x] Task 4 (AC-1): update root route access in gestionale_riparazioni/urls.py by removing @login_required from home_view so anonymous visitors can load /.
- [x] Task 5 (AC-1, AC-2, AC-4, AC-5): add frontend tests for section presence, CTA hrefs, 390px overflow behavior, and invalid-query resilience in a new spec file under packages/frontend/src/.
- [x] Task 6 (AC-3): add a reproducible Lighthouse mobile check script in package.json and store JSON/result output in docs/sprint-artifacts/lighthouse-9.1.json and docs/sprint-artifacts/test-output-9.1.txt.

## Step 4 Validation Fixes

- Issue 1: AC-1 used generic wording (service highlights, trust section) that was too ambiguous for deterministic UI assertions.
  Fix: constrained AC-1 to concrete visible blocks and labels (Riparazioni rapide e trasparenti, Recensioni, FAQ, Contatti, CTA href /richiedi-preventivo).
- Issue 2: AC-3 did not define a reproducible Lighthouse command or measurable artifact location.
  Fix: added explicit CLI command, output file path (docs/sprint-artifacts/lighthouse-9.1.json), and exact threshold check on categories.performance.score >= 0.85.
- Issue 3: Story had no explicit sad path for invalid input/error handling.
  Fix: added AC-5 for unsupported query input (/?layout=broken) and mapped it to dedicated test coverage in Task 5.
